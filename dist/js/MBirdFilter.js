class MBirdFilter{constructor(){this.filterFormData=jQuery("#mbird-filter-form").serialize(),this.currentPage=1,this._init()}_init(){jQuery("#mbird-filter-form").on("submit",r=>{r.preventDefault()}),jQuery("#mbird-filter-form").on("change",r=>{r.preventDefault(),this._runFilters()}),this._loadData(),jQuery("#mbird-load-more").on("click",r=>{r.preventDefault(),this.currentPage++,this._loadData()})}_loadData(){jQuery("#mbird-filter-loader").show();var r=jQuery('input[name="shortcode_atts"]').val();jQuery.ajax({url:mbirdFilters.ajaxurl,type:"POST",data:{action:"mbird_initial_load",security:jQuery("#mbird_filter_nonce_field").val(),shortcode_atts:r,page:this.currentPage},success:function(r){r?jQuery("#mbird-filter-results").append(r):(jQuery("#mbird-load-more").remove(),jQuery("#mbird-filter-results").html('<p class="no-results">No posts found.</p>'))},error:function(r,e,t){console.error("AJAX error:",e,t)},complete:()=>{jQuery("#mbird-filter-loader").hide()}})}_runFilters(){var r=jQuery("#mbird-filter-form").serializeArray();let a=JSON.parse(jQuery('input[name="shortcode_atts"]').val());Object.keys(a.tax_query).forEach(r=>{Array.isArray(a.tax_query[r].terms)&&(a.tax_query[r].terms=[])}),r.forEach(t=>{if(t.name.startsWith("filter-")){let e=t.name.replace("filter-","");Object.keys(a.tax_query).forEach(r=>{a.tax_query[r].taxonomy===e&&a.tax_query[r].terms.push(t.value)})}}),jQuery('input[name="shortcode_atts"]').val(JSON.stringify(a)),console.log(jQuery('input[name="shortcode_atts"]').val()),this.currentPage=1,jQuery("#mbird-filter-results").empty(),this._loadData()}}